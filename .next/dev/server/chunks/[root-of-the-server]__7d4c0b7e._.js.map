{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/New%20folder/lib/auth.ts"],"sourcesContent":["import { cookies } from \"next/headers\"\nimport { SignJWT, jwtVerify } from \"jose\"\n\nconst secretKey = new TextEncoder().encode(process.env.JWT_SECRET || \"whispering-petals-secret-key-2024\")\n\nexport interface User {\n  id: number\n  email: string\n  role: string\n}\n\n// Demo admin credentials (in production, this would be in a database)\nexport const DEMO_ADMIN = {\n  id: 1,\n  email: \"admin@whisperingpetals.com\",\n  password: \"admin123\",\n  role: \"admin\",\n}\n\nexport async function createToken(user: User): Promise<string> {\n  const token = await new SignJWT({ userId: user.id, email: user.email, role: user.role })\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setExpirationTime(\"24h\")\n    .sign(secretKey)\n  return token\n}\n\nexport async function verifyToken(token: string): Promise<User | null> {\n  try {\n    const { payload } = await jwtVerify(token, secretKey)\n    return {\n      id: payload.userId as number,\n      email: payload.email as string,\n      role: payload.role as string,\n    }\n  } catch {\n    return null\n  }\n}\n\nexport async function getUser(): Promise<User | null> {\n  const cookieStore = await cookies()\n  const token = cookieStore.get(\"auth-token\")?.value\n  if (!token) return null\n  return verifyToken(token)\n}\n\nexport async function setAuthCookie(token: string) {\n  const cookieStore = await cookies()\n  cookieStore.set(\"auth-token\", token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"lax\",\n    maxAge: 60 * 60 * 24, // 24 hours\n    path: \"/\",\n  })\n}\n\nexport async function removeAuthCookie() {\n  const cookieStore = await cookies()\n  cookieStore.delete(\"auth-token\")\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;AAAA;;;AAEA,MAAM,YAAY,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI;AAS9D,MAAM,aAAa;IACxB,IAAI;IACJ,OAAO;IACP,UAAU;IACV,MAAM;AACR;AAEO,eAAe,YAAY,IAAU;IAC1C,MAAM,QAAQ,MAAM,IAAI,kKAAO,CAAC;QAAE,QAAQ,KAAK,EAAE;QAAE,OAAO,KAAK,KAAK;QAAE,MAAM,KAAK,IAAI;IAAC,GACnF,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,iBAAiB,CAAC,OAClB,IAAI,CAAC;IACR,OAAO;AACT;AAEO,eAAe,YAAY,KAAa;IAC7C,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,sKAAS,EAAC,OAAO;QAC3C,OAAO;YACL,IAAI,QAAQ,MAAM;YAClB,OAAO,QAAQ,KAAK;YACpB,MAAM,QAAQ,IAAI;QACpB;IACF,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,eAAe;IAC7C,IAAI,CAAC,OAAO,OAAO;IACnB,OAAO,YAAY;AACrB;AAEO,eAAe,cAAc,KAAa;IAC/C,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,GAAG,CAAC,cAAc,OAAO;QACnC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,QAAQ,KAAK,KAAK;QAClB,MAAM;IACR;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,MAAM,CAAC;AACrB"}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///D:/New%20folder/app/api/auth/login/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport { cookies } from \"next/headers\"\nimport { createToken, DEMO_ADMIN } from \"@/lib/auth\"\n\nexport async function POST(request: Request) {\n  try {\n    const { email, password } = await request.json()\n\n    // Validate input\n    if (!email || !password) {\n      return NextResponse.json({ error: \"Email and password are required\" }, { status: 400 })\n    }\n\n    const cookieStore = await cookies()\n\n    const customCredentials = cookieStore.get(\"admin-credentials\")?.value\n    let adminEmail = DEMO_ADMIN.email\n    let adminPassword = DEMO_ADMIN.password\n\n    if (customCredentials) {\n      try {\n        const parsed = JSON.parse(customCredentials)\n        if (parsed.email) adminEmail = parsed.email\n        if (parsed.password) adminPassword = parsed.password\n      } catch {\n        // Use defaults if parsing fails\n      }\n    }\n\n    // Check credentials\n    if (email !== adminEmail || password !== adminPassword) {\n      return NextResponse.json({ error: \"Invalid email or password\" }, { status: 401 })\n    }\n\n    // Create JWT token\n    const token = await createToken({\n      id: DEMO_ADMIN.id,\n      email: adminEmail,\n      role: DEMO_ADMIN.role,\n    })\n\n    // Set auth cookie\n    cookieStore.set(\"auth-token\", token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      sameSite: \"lax\",\n      maxAge: 60 * 60 * 24, // 24 hours\n      path: \"/\",\n    })\n\n    return NextResponse.json({\n      success: true,\n      user: {\n        id: DEMO_ADMIN.id,\n        email: adminEmail,\n        role: DEMO_ADMIN.role,\n      },\n    })\n  } catch {\n    return NextResponse.json({ error: \"Internal server error\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE9C,iBAAiB;QACjB,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkC,GAAG;gBAAE,QAAQ;YAAI;QACvF;QAEA,MAAM,cAAc,MAAM,IAAA,4IAAO;QAEjC,MAAM,oBAAoB,YAAY,GAAG,CAAC,sBAAsB;QAChE,IAAI,aAAa,2HAAU,CAAC,KAAK;QACjC,IAAI,gBAAgB,2HAAU,CAAC,QAAQ;QAEvC,IAAI,mBAAmB;YACrB,IAAI;gBACF,MAAM,SAAS,KAAK,KAAK,CAAC;gBAC1B,IAAI,OAAO,KAAK,EAAE,aAAa,OAAO,KAAK;gBAC3C,IAAI,OAAO,QAAQ,EAAE,gBAAgB,OAAO,QAAQ;YACtD,EAAE,OAAM;YACN,gCAAgC;YAClC;QACF;QAEA,oBAAoB;QACpB,IAAI,UAAU,cAAc,aAAa,eAAe;YACtD,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACjF;QAEA,mBAAmB;QACnB,MAAM,QAAQ,MAAM,IAAA,4HAAW,EAAC;YAC9B,IAAI,2HAAU,CAAC,EAAE;YACjB,OAAO;YACP,MAAM,2HAAU,CAAC,IAAI;QACvB;QAEA,kBAAkB;QAClB,YAAY,GAAG,CAAC,cAAc,OAAO;YACnC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK;YAClB,MAAM;QACR;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;gBACJ,IAAI,2HAAU,CAAC,EAAE;gBACjB,OAAO;gBACP,MAAM,2HAAU,CAAC,IAAI;YACvB;QACF;IACF,EAAE,OAAM;QACN,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF"}}]
}